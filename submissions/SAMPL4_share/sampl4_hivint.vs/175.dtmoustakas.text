We used a pharmacophore docking code based on the PhDOCK method reported in [Joseph-McCarthy et. al, Proteins: Structure, Function, and Bioinformatics, 51(2), 2003].  PhDOCK is derived from the DOCK program [Ewing et. al, JCAMD, 15(5), 2001], which is based on using "spheres" to characterize the accessible volume of the pocket.  A small molecule is rigidly oriented in the binding site by matching heavy atoms to the sphere positions using a maximal-clique matching algorithm.  PhDOCK uses spheres that represent the positions of pharmacophoric features within the site: hydrogen bond donors, acceptors, and hydrophobes.  The underlying principle is that by matching pharmacophoric features on the ligand with pharmacophoric features on the receptor, then the ligand orientations that are generated will be more likely to produce complimentary protein-ligand interactions, thus hopefully reducing the number of decoy poses that the scoring function must later properly rank.  PhDOCK uses the contact score to rank poses and select those that best fit into the site.  The contact score is a low-resolution van der Waals potential: VDW clashes have a penalty of +50, and favorable contacts have a score of -1.  This softened function identifies ligand poses that fit the overall shape of the pocket well, without overly penalizing orientations that yield clashes.

PhDOCK uses a flexibase approach, in which ligand conformations are pre-computed using Omega2, and each ligand conformation is rigidly docked into the site.  This approach relies on the scoring function to eliminate those conformers that poorly match the shape of the site, and since the ligand conformations may not be perfectly generated, the softened contact score allows for slightly non-ideal conformations to fit into the pocket.

We implemented a new version of the PhDOCK code in python, using the OEChem toolkit.  The receptor spheres were generated by aligning the large set of HIV IN structures referenced in the papers for the SAMPL challenge, and assuming that the critical pharmacophore points were likley sampled already by existing ligands/fragments from the set of X-ray crystal structures.  We used the reference structure (3NF8) to dock against, so all of the other crystal structures were aligned to the 3NF8 structure, and in doing so, all the ligands and fragments were aligned into the A, B, and C pockets of the 3NF8 structure.  PhDOCK spheres were extracted from the ligand structures for each of the 3 pockets, and those spheres were then used to define the position for PhDOCK contact score grids to be generated for each of the 3 sites.

For each ligand in the challenge set, Quacpac was used to assign AM1BCC partial charges.  Next, Omega2 was used to generate conformers within a 2.0 kcal/mol window, with no maximum number of conformers set.  The resulting multiconformer ligand database served as the virtual screening set for the dockings.

We also prepared a number of the X-ray crystal structure ligands to dock as references with known biological activity into the various sites.  In particular, the ligands referenced in the Peat et. al. paper were useful, as they were known to bind to site C (which we focused on), and they had binding data reported in the paper.

PhDOCK was used to dock both the reference ligands and the challenge ligands against the 3 sites, using standard PhDOCK parameters.  A maximum of 20 poses of each ligand were written out into an oeb.gz file, with the contact score value saved for each ligand.  We made several other entries to this challenge, all of which use these poses, but that apply a rescoring protocol to evaluate what effect different scoring functions have on virtual screening performance.

After writing out the docked poses (generated using the contact score), the saved poses were then rescored with the SZMAP program from OpenEye.  The SZMAP grid for the "pseudo-apo" protein structure (unliganded) was calculated, and the neutral difference free energy grid was calculated.  The overlap of the ligand poses with the positive region of the n_ddG grid was computed using the Rocs program from OpenEye.  Basically, this computes the overlap of the ligand poses with the SZMAP-predicted "hydrophobic hotspots" on the protein - where the water should be most easily displaced from the site.  The hypothesis being tested is that good ligand poses will maximally occupy those hotspot regions, in order to minimize the desolvation penalty of binding.  In this case, the final ligand score was the the SZMAP overlap score; which should give preference to those poses that maximally overlap the hotspots.  This experiment explores whether the solvation score alone could better rank the ligands.

Finally, the ligands were re-ranked based on the median rank for all the poses of that ligand - so for each ligand, the median rank of it's 20 poses was used to rank the ligands - to preferentially bias those ligands that generated multiple good-scoring poses.  This treatment appeared to most accurately rank the reference ligands, and hopefully reduces the likelihood that a single good-scoring decoy pose of a ligand could alter the ranking of the hitlist.



